import{r as k,d as C,a as p,u as F,b as L,c as i,o as f,e as y,f as P,g as o,w as u,F as T,h as B,i as D,j as E,k as K}from"./index-d1f6f85b.js";import{u as $}from"./user-68ae85c9.js";const j=()=>k({url:"/menus",method:"post"}),G=()=>k({url:"/user/login",method:"get"}),x=[{label:"本地",value:"http://192.168.125.241:3012/user-tower/auth-redirect",dataPortalUrl:"http://localhost:3014/transfer.html#",commRedirectUrl:"https://web-dev.shuxinyc.shop/#/",abTestUrl:"http://localhost:3014/transfer.html#/auth-redirect"},{label:"开发",value:"https://cdp-dev.shuxinyc.shop/user-tower/auth-redirect",dataPortalUrl:"https://data-portal-dev.shuxinyc.shop/transfer.html#",commRedirectUrl:"https://web-dev.shuxinyc.shop/#/",abTestUrl:"https://abtest-mng-dev.shuxinyc.shop/abtest-web/transfer.html#/auth-redirect"},{label:"测试",value:"https://cdp-qa.shuxinyc.shop/user-tower/auth-redirect",dataPortalUrl:"https://data-portal-qa.shuxinyc.shop/transfer.html#",commRedirectUrl:"https://web-test.shuxinyc.shop/#/",abTestUrl:"https://abtest-mng-qa.shuxinyc.shop/abtest-web/transfer.html#/auth-redirect"},{label:"生产",value:"https://cdp.shuxinyc.shop/user-tower/auth-redirect",dataPortalUrl:"https://data-portal.shuxinyc.shop/transfer.html#",commRedirectUrl:"https://web.shuxinyc.shop/#/",abTestUrl:"https://abtest-mng.shuxinyc.shop/abtest-web/transfer.html#/auth-redirect",disabled:!0}],H={class:"home-waraper"},M={class:"form-container w-35%"},Q=C({__name:"index",setup(O){var g;const w={children:"children",label:"label"},b=p(),d=$(),_=F(),h=p([]),v=p(),n=p({env:(g=d.env)!=null&&g.label?d.env:x[0],phoneNumber:d.phoneNumber||"18228329236",token:d.token,groupId:"267356",menuList:[]}),U=L({env:[{required:!0,message:"请选择"}],phoneNumber:[{required:!0,validator:(t,e,r)=>{e===""?r(new Error("请输入手机号")):/^1[3-9]\d{9}$/.test(e)?r():r(new Error("请输入正确手机号"))}}],token:[{required:!0,message:"请输入token"}],groupId:[{required:!0,message:"请输入集团id"}]});(()=>{j().then(t=>{h.value=t.data}),G().then(t=>{d.login(t.data)})})();const V=t=>h.value.filter(r=>{var c;const a=t.includes(r.id),l=(c=r.children)==null?void 0:c.some(m=>t.includes(m.id));return!(!a&&!l)}).map(r=>{var a;return{...r,children:(a=r.children)==null?void 0:a.filter(l=>t.includes(l.id))}}),N=()=>{let t=[];const e=(r,a)=>{r.forEach(l=>{a&&t.push(l.id),l.children&&e(l.children,!0)})};return e(d.menuList,!1),t.length?t:["1","2","3","4","5"]},R=(t,e)=>{t&&t.validate(r=>{if(r){const a=b.value.getCheckedKeys();d.setUserInfo({...n.value,menuList:V(a)}),e==="1"?_.push("/label-tank"):e==="2"&&_.push("/system")}})};return(t,e)=>{const r=i("el-option"),a=i("el-select"),l=i("el-form-item"),c=i("el-input"),m=i("el-tree"),q=i("el-button"),I=i("el-form");return f(),y("div",H,[P("div",M,[o(I,{ref_key:"ruleFormRef",ref:v,model:n.value,rules:U,"label-width":"auto"},{default:u(()=>[o(l,{prop:"env",label:"接入外部系统环境:"},{default:u(()=>[o(a,{modelValue:n.value.env,"onUpdate:modelValue":e[0]||(e[0]=s=>n.value.env=s)},{default:u(()=>[(f(!0),y(T,null,B(D(x),s=>(f(),K(r,{key:s,label:s.label,value:s,disabled:s.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(l,{prop:"groupId",label:"集团id:"},{default:u(()=>[o(c,{modelValue:n.value.groupId,"onUpdate:modelValue":e[1]||(e[1]=s=>n.value.groupId=s),placeholder:"请输入集团id",clearable:"",maxlength:"20",disabled:""},null,8,["modelValue"])]),_:1}),o(l,{prop:"token",label:"商业化平台token:"},{default:u(()=>[o(c,{modelValue:n.value.token,"onUpdate:modelValue":e[2]||(e[2]=s=>n.value.token=s),placeholder:"请输入商业化平台token",clearable:""},null,8,["modelValue"])]),_:1}),o(l,{prop:"menuList",label:"菜单权限:"},{default:u(()=>[o(m,{ref_key:"treeRef",ref:b,style:{width:"200px"},data:h.value,"show-checkbox":"","node-key":"id",props:w,"default-expand-all":"","default-checked-keys":N()},null,8,["data","default-checked-keys"])]),_:1}),o(l,{label:" "},{default:u(()=>[o(q,{type:"primary",onClick:e[3]||(e[3]=s=>R(v.value,"1"))},{default:u(()=>[E("跳转至商业化平台对接")]),_:1})]),_:1})]),_:1},8,["model","rules"])])])}}});export{Q as default};
//# sourceMappingURL=index-c598a6af.js.map
