import{d as w,r as c,u as C,a as U,b as V,c as u,o as R,e as D,f as L,g as l,w as s,h as y}from"./index-5927132b.js";import{r as B}from"./request-7267a692.js";import{g as E}from"./user-15dceef1.js";const F=()=>B({url:"/menus",method:"post"}),$={class:"home-waraper"},q={class:"form-container"},T=w({__name:"index",setup(I){const g={children:"children",label:"label"},h=c(),i=C(),b=U(),m=c([]),p=c(),d=c({phoneNumber:i.phoneNumber||"18228329236",menuList:[]}),k=V({phoneNumber:[{required:!0,validator:(e,t,r)=>{t===""?r(new Error("请输入手机号")):/^1[3-9]\d{9}$/.test(t)?r():r(new Error("请输入正确手机号"))}}]});(()=>{F().then(e=>{m.value=e.data}),E().then(e=>{i.login(e.data)})})();const x=e=>m.value.filter(r=>{var a;const o=e.includes(r.id),n=(a=r.children)==null?void 0:a.some(f=>e.includes(f.id));return!(!o&&!n)}).map(r=>{var o;return{...r,children:(o=r.children)==null?void 0:o.filter(n=>e.includes(n.id))}}),N=()=>{let e=[];const t=(r,o)=>{r.forEach(n=>{o&&e.push(n.id),n.children&&t(n.children,!0)})};return t(i.menuList,!1),e.length?e:["1","2"]},v=(e,t)=>{e&&e.validate(r=>{if(r){const o=h.value.getCheckedKeys();i.setUserInfo({phoneNumber:d.value.phoneNumber,menuList:x(o)}),t==="1"?b.push("/label-tank"):t==="2"&&b.push("/system")}})};return(e,t)=>{const r=u("el-input"),o=u("el-form-item"),n=u("el-tree"),a=u("el-button"),f=u("el-form");return R(),D("div",$,[L("div",q,[l(f,{ref_key:"ruleFormRef",ref:p,model:d.value,rules:k,"label-width":"auto"},{default:s(()=>[l(o,{prop:"phoneNumber",label:"用户手机号:"},{default:s(()=>[l(r,{modelValue:d.value.phoneNumber,"onUpdate:modelValue":t[0]||(t[0]=_=>d.value.phoneNumber=_),placeholder:"请输入手机号",clearable:"",maxlength:"20",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),l(o,{prop:"menuList",label:"菜单权限:"},{default:s(()=>[l(n,{ref_key:"treeRef",ref:h,style:{width:"200px"},data:m.value,"show-checkbox":"","node-key":"id",props:g,"default-expand-all":"","default-checked-keys":N()},null,8,["data","default-checked-keys"])]),_:1}),l(o,{label:" "},{default:s(()=>[l(a,{type:"primary",onClick:t[1]||(t[1]=_=>v(p.value,"1"))},{default:s(()=>[y("跳转至标签智库")]),_:1}),l(a,{type:"primary",onClick:t[2]||(t[2]=_=>v(p.value,"2"))},{default:s(()=>[y("跳转至内部系统")]),_:1})]),_:1})]),_:1},8,["model","rules"])])])}}});export{T as default};
//# sourceMappingURL=index-5c9be402.js.map
