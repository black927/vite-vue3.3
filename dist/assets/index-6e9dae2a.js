import{r as C,d as T,a as p,u as B,b as F,c as i,o as b,e as y,f as P,g as s,w as d,F as D,h as L,i as E,j as A,k as K}from"./index-b9390d7e.js";import{u as S}from"./user-04e30f2d.js";const $=[{id:"1",label:"人群智库",path:"",name:"",meta:{title:"人群智库"},children:[{id:"1-1",label:"用户群体",path:"/user-tower",name:"user-tower",meta:{title:"用户群体"}},{id:"1-2",label:"人群洞察",path:"/crowd-insight",name:"crowd-insight",meta:{title:"人群洞察"}}]},{id:"2",label:"标签管理",path:"",name:"",meta:{title:"标签管理"},children:[{id:"2-1",label:"用户标签",path:"/user-label",name:"user-label",meta:{title:"用户标签"}}]},{id:"5",label:"报表中心",path:"/report-center",name:"report-center",meta:{title:"报表中心",link:"/home/index"},children:[]},{id:"6",label:"ABTest",path:"",name:"",meta:{title:"ABTest"},children:[{id:"6-1",label:"应用管理",path:"/app-manage",name:"/app-manage",meta:{title:"应用管理"}},{id:"6-2",label:"实验层",path:"/experiment-manage-list",name:"experiment-manage-list",meta:{title:"实验层"}},{id:"6-3",label:"实验列表",path:"/experiment-manage-layer",name:"experiment-manage-layer",meta:{title:"实验列表"}}]}],j=()=>new Promise(f=>{f({code:200,data:$,msg:"请求成功",traceId:Date.now().toString()})}),G=()=>C({url:"/user/login",method:"get"}),w=[{label:"本地",value:"http://192.168.125.241:3012/user-tower/auth-redirect",dataPortalUrl:"http://localhost:3014/transfer.html#",commRedirectUrl:"https://web-dev.shuxinyc.shop/#/",abTestUrl:"http://localhost:3014/transfer.html#/auth-redirect"},{label:"开发",value:"https://cdp-dev.shuxinyc.shop/user-tower/auth-redirect",dataPortalUrl:"https://data-portal-dev.shuxinyc.shop/transfer.html#",commRedirectUrl:"https://web-dev.shuxinyc.shop/#/",abTestUrl:"https://abtest-mng-dev.shuxinyc.shop/abtest-web/transfer.html#/auth-redirect"},{label:"测试",value:"https://cdp-qa.shuxinyc.shop/user-tower/auth-redirect",dataPortalUrl:"https://data-portal-qa.shuxinyc.shop/transfer.html#",commRedirectUrl:"https://web-test.shuxinyc.shop/#/",abTestUrl:"https://abtest-mng-qa.shuxinyc.shop/abtest-web/transfer.html#/auth-redirect"},{label:"生产",value:"https://cdp.shuxinyc.shop/user-tower/auth-redirect",dataPortalUrl:"https://data-portal.shuxinyc.shop/transfer.html#",commRedirectUrl:"https://web.shuxinyc.shop/#/",abTestUrl:"https://abtest-mng.shuxinyc.shop/abtest-web/transfer.html#/auth-redirect",disabled:!0}],H={class:"home-waraper"},M={class:"form-container w-35%"},W=T({__name:"index",setup(f){var x;const k={children:"children",label:"label"},_=p(),u=S(),g=B(),m=p([]),v=p(),o=p({env:(x=u.env)!=null&&x.label?u.env:w[0],phoneNumber:u.phoneNumber||"18228329236",token:u.token,groupId:"267356",menuList:[]}),U=F({env:[{required:!0,message:"请选择"}],phoneNumber:[{required:!0,validator:(t,e,a)=>{e===""?a(new Error("请输入手机号")):/^1[3-9]\d{9}$/.test(e)?a():a(new Error("请输入正确手机号"))}}],token:[{required:!0,message:"请输入token"}],groupId:[{required:!0,message:"请输入集团id"}]});(()=>{j().then(t=>{m.value=t.data}),G().then(t=>{u.login(t.data)})})();const V=t=>m.value.filter(a=>{var c;const r=t.includes(a.id),l=(c=a.children)==null?void 0:c.some(h=>t.includes(h.id));return!(!r&&!l)}).map(a=>{var r;return{...a,children:(r=a.children)==null?void 0:r.filter(l=>t.includes(l.id))}}),N=()=>{let t=[];const e=(a,r)=>{a.forEach(l=>{r&&t.push(l.id),l.children&&e(l.children,!0)})};return e(u.menuList,!1),t.length?t:["1","2","3","4","5"]},I=(t,e)=>{t&&t.validate(a=>{if(a){const r=_.value.getCheckedKeys();u.setUserInfo({...o.value,menuList:V(r)}),e==="1"?g.push("/label-tank"):e==="2"&&g.push("/system")}})};return(t,e)=>{const a=i("el-option"),r=i("el-select"),l=i("el-form-item"),c=i("el-input"),h=i("el-tree"),R=i("el-button"),q=i("el-form");return b(),y("div",H,[P("div",M,[s(q,{ref_key:"ruleFormRef",ref:v,model:o.value,rules:U,"label-width":"auto"},{default:d(()=>[s(l,{prop:"env",label:"接入外部系统环境:"},{default:d(()=>[s(r,{modelValue:o.value.env,"onUpdate:modelValue":e[0]||(e[0]=n=>o.value.env=n)},{default:d(()=>[(b(!0),y(D,null,L(E(w),n=>(b(),K(a,{key:n,label:n.label,value:n,disabled:n.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(l,{prop:"groupId",label:"集团id:"},{default:d(()=>[s(c,{modelValue:o.value.groupId,"onUpdate:modelValue":e[1]||(e[1]=n=>o.value.groupId=n),placeholder:"请输入集团id",clearable:"",maxlength:"20",disabled:""},null,8,["modelValue"])]),_:1}),s(l,{prop:"token",label:"商业化平台token:"},{default:d(()=>[s(c,{modelValue:o.value.token,"onUpdate:modelValue":e[2]||(e[2]=n=>o.value.token=n),placeholder:"请输入商业化平台token",clearable:""},null,8,["modelValue"])]),_:1}),s(l,{prop:"menuList",label:"菜单权限:"},{default:d(()=>[s(h,{ref_key:"treeRef",ref:_,style:{width:"200px"},data:m.value,"show-checkbox":"","node-key":"id",props:k,"default-expand-all":"","default-checked-keys":N()},null,8,["data","default-checked-keys"])]),_:1}),s(l,{label:" "},{default:d(()=>[s(R,{type:"primary",onClick:e[3]||(e[3]=n=>I(v.value,"1"))},{default:d(()=>[A("跳转至商业化平台对接")]),_:1})]),_:1})]),_:1},8,["model","rules"])])])}}});export{W as default};
//# sourceMappingURL=index-6e9dae2a.js.map
